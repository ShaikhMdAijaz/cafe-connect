<!-- <app-header></app-header> -->

<div class="container-fluid page-container p-0">
  <ng-container *ngIf="!isInvoiceVisible">

    <!-- Menu Selector -->
    <div class="menu-selector">
      <div [attr.class]="selectedCategory === 'Burger' || selectedCategory === 'Breakfast' 
          ? 'sub-sticky-header col-md-12 p-0' 
          : 'sticky-header col-md-12 p-0'" class="bg-light p-2 rounded shadow-sm mb-3">

        <!-- Search & Action Buttons Row -->
        <div class="row align-items-center g-2">
          <!-- Search Bar -->
          <div class="col-md-6 col-12 mt-3">
            <input type="text" class="form-control" [(ngModel)]="searchText" placeholder="Search Beverage..."
              (input)="filteredAndSearchedMenu(searchText)" />
          </div>

          <!-- Action Buttons -->
          <div class="col-md-6 col-12 d-flex flex-wrap justify-content-start">
            <button class="btn me-2 mr-2" (click)="resetOrder()">
              Reset Order
            </button>
            <button class="view-cart-btn" (click)="onClickViewCart()">
              ðŸ›’ View Cart <span *ngIf="userCartDetails.length>0">({{userCartDetails.length}})</span> 
            </button>
            <!-- <button class="btn position-relative view-cart-btn" (click)="onClickViewCart()">
  <i class="bi bi-cart3 fs-3"></i>
  <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-primary">
    {{ userCartDetails.length }}
  </span>
  <div class="small">Cart</div>
</button>
<button type="button" class="btn position-relative text-center view-cart-btn" (click)="onClickViewCart()">
  <i class="fa fa-shopping-cart"></i>
  <span class="badge badge-pill badge-primary cart-badge">
    {{ userCartDetails.length }}
  </span>
  <div class="small">Cart</div>
</button> -->
          </div>
        </div>

        <!-- Category Buttons -->
        <div class="d-flex flex-wrap justify-content-start mt-3">
          <!-- <button *ngFor="let category of categories" 
            class="btn btn-sm me-2 mb-2 mr-2 category-buttons"
            [ngClass]="{ 'active': selectedCategory == category.name}"
            (click)="filterByCategory(category.name)">
            {{ category.name }}<br />
            <small>{{ category.count }} Items</small>
          </button> -->
          <button *ngFor="let category of categories" class="btn-sm me-2 px-4 pt-1 mb-2 mr-2 category-buttons"
            [ngClass]="{ 'active': selectedCategory == category.name}" (click)="filterByCategory(category.name)">
            <span class="d-block">{{ category.name }}</span>
            <small class="d-block">{{ category.count }} Items</small>
          </button>
        </div>

        <!-- Subcategory Buttons -->
        <div class="d-flex flex-wrap justify-content-start mt-1 mb-2"
          *ngIf="selectedCategory == 'Burger' || selectedCategory == 'Breakfast'">
          <button class="btn-sm me-2 mr-2 category-buttons" [ngClass]="{'active': selectedSubCategory == 'veg'}"
            (click)="filterBySubCategory('veg')">
            Veg
          </button>
          <button class="btn-sm category-buttons" [ngClass]="{ 'active': selectedSubCategory == 'non-veg'}"
            (click)="filterBySubCategory('non-veg')">
            Non-Veg
          </button>
        </div>
      </div>
    </div>

    <!-- Menu Items -->
    <div *ngIf="selectedBeverage"
      [attr.class]="selectedCategory == 'Burger' || selectedCategory == 'Breakfast' ? 'sub-menu-items d-block mx-2' : 'menu-items d-block mx-2'">
      <div class="row g-3">
        <div class="col-lg-3 col-md-4 col-sm-6 col-12 mb-2" *ngFor="let item of filteredMenuItems; let i = index">

          <div class="card shadow-sm position-relative menu-card1">
            <!-- Veg / Non-Veg Icon -->
            <div class="position-absolute top-0 right-0 p-2">
              <img *ngIf="item.subType === 'veg'" src="assets/images/veg-icon.webp" alt="Veg" width="20" height="20" />
              <img *ngIf="item.subType === 'non-veg'" src="assets/images/non-veg-icon1.png" alt="Non-Veg" width="20"
                height="20" />
            </div>

            <img [src]="item.image" class="card-img-top fixed-img" alt="{{ item.description }}">
            <div class="card-body d-flex flex-column p-2">
              <h6 class="card-title mb-1 font-weight-bold">{{ item.description }}</h6>
              <p class="card-text mb-1">Price: â‚¹{{ item.rate }}</p>
              <button class="mt-auto"
                [ngClass]="item.type === 'breakfast' && !isBreakfastFlag ? 'disabled-btn' : 'add-btn'"
                (click)="selectItem(item)" [disabled]="item.type === 'breakfast' && !isBreakfastFlag">
                {{item.type === 'breakfast' && !isBreakfastFlag ? 'Breakfast Not Available' : 'Add+'}}
              </button>
            </div>
          </div>

        </div>
      </div>
    </div>

  </ng-container>
</div>

<!-- Cart side panel -->
<app-cart [isOpen]="showCart" (close)="closeCartPop($event)" (addToProceed)="addToProceed($event)"
  (itemIncrementDecrement)="itemIncrementDecrement($event)" [userID]="userDetails?.userID" [userDetails]="userDetails"></app-cart>
<app-checkout [userBill]="userBill" [totalAmount]="totalAmount" [cgstAmount]="cgstAmount" [sgstAmount]="sgstAmount"
  [isInvoiceVisible]="isInvoiceVisible" (customizeOrder)="customizeOrder($event)" [order]="order"
  [userAddress]="userAddress"></app-checkout>